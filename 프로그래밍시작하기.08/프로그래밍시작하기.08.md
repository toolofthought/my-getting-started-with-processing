# 이미지 다루기 #

## 이미지 읽고 쓰기 ##
아직까지 이미지를 정식으로 다루지는 않았지만 이미 여러 번 이미지 파일을 다루었습니다. 이제 정식으로 이미지 파일을 다루는 법을 배워봅시다.
### 내 컴퓨터에서 이미지 읽기 ###
우선 이미지 파일을 추가합니다. 이미지 파일을 드래그해서 프로세싱 코드 편집창 위에서 마우스 버튼을 클릭합시다.

이렇게 이미지 파일을 추가한 이미지를 프로세싱에서 사용하는 데는 두 단계가 필요합니다.
#### 이미지 파일 변수 지정 ####
우선 이미지를 읽어들여야 합니다. 이미지를 불러와 이미지 파일을 지칭하는 변수에 저장을 합니다. 이미지 파일 자체를 변수에 저장하는 것이 아니라 이미지 파일을 참고(reference)하는 방법은 편리하고 여러 군데서 사용됩니다.

이미지 파일을 가리키는 변수는 PImage 타입을 띕니다. 더 정확하게 이야기하자면 PImage 클래스의 인스턴스라고 지칭하는 것이 맞지만 일단은 넘어가기로 합시다. 이것이 무슨 말인지 궁금하시면 조금만 기다려주세요. 객체지향 프로그래밍에 대해 배우게 되면 이 말이 어떤 뜻인지 알게 될 것입니다. 이미지 파일을 가리키는 변수는 일단 Pimage 타입을 가진다고 이해하고 넘어갑시다.

	PImage img;

loadImage() 함수는 이미지 파일의 위치를 입력값을 받아 변수에 저장합니다. 

	PImage img = loadImage("yourImage.jpg");

파일의 정확한 위치를 지정하면 내 컴퓨터에 있는 이미지 파일을 어떤 것이나 변수에 저장할 수 있습니다.

#### 화면에 이미지 띄우기 ####
이제 정말 화면에 이미지를 표시할 차례입니다. image() 함수를 이용해 이미지를 화면에 띄울 수 있습니다. 자세한 설명을 하기 전 일단 동작하는 예를 보고 설명을 이어갑시다.

복잡한 기능을 가지고 있는 프로그램을 한 번에 모두 작성하려고 하는 시도는 120%의 확류로 실패합니다. 언제나 작게 조금씩 기능을 추가하고 새로운 라인을 추가하면 자주 제대로 돌아가는지 확인하는 습관을 기르는 것도 좋겠습니다.

	//myHelloImage
	PImage img;
	void setup() {
		size(480, 360);
		img = loadImage("myImage.jpg");
	}

	void draw() {
		image(img, 0, 0, 240, 180);
		image(img, 240, 0, 240, 180);
		image(img, 0, 180, 480, 180);
	}
![](http://i.imgur.com/7NJWDBS.jpg)

[원본 링크](https://www.wallsandfloors.co.uk/range/jewel-tone-prismatic-tiles)

image() 파일의 입력값을 살펴봅시다.

	image(PImage img, float x, float y, float imageWidth, float imageHeight);

표시할 이미지를 정하고, 이미지의 위치를 정합니다. 그리고 이미지의 너비와 높이를 정합니다. 혹시 너비와 높이를 따로 정하지 않으면 화면의 크기인 width와 height를 기본값으로 사용합니다.
### 웹에서 이미지 읽기 ###
웹에서 이미지를 가져오는 것과 내 컴퓨터에서 이미지 파일을 가져오는 것은 차이가 거의 없습니다. 이미지 파일의 위치를 loadImage()에 입력하는 대신 이미지 파일의 URL주소를 입력해야 하는 차이가 있을 뿐입니다.

	//myHelloWebImage
	String URL = "http://cfile3.uf.tistory.com/image/222B06505657E2700AD5B9";
	
	PImage img;
	
	void setup() {
		size(740, 1108);
		img = loadImage(URL, "jpg");
	}
	
	void draw() {
		image(img, 0, 0);
	}
![](http://i.imgur.com/WjuBJOA.jpg)

이제 이미지 파일 주소만 알면 언제든지 파일을 화면에 띄울 수 있습니다.
## 이미지 변형하기 ##
주어진 이미지를 그대로 사용하는데는 한계가 있습니다. 원하는 데로 이미지를 편집하고 색을 바꾸거나 투명도를 조절해봅시다. 
### 이미지 잘라내기 ###
이전에 설명하기를 프로세싱은 여러 데이터 타입을 가지고 있고 연산되는 방식이 데이터 타입에 따라 다르다고 했습니다. 이미지 타입을 지칭하는 PImage 타입(정확하게 말하면 클래스)도 이미지를 어떻게 연산하는지 미리 정해두었습니다. PImage 타입이 어떻게 연산 혹은 동작하는지를 정한 함수(정확하게는 메서드)를 이용하면
우리가 원하는 작업을 쉽게 할 수 있습니다.

이미지를 잘라내는 작업은 get() 메서드를 사용하면 쉽게 할 수 있습니다. 설명을 이어가기 전 우선 get() 메서드를 이용한 예를 먼저 보겠습니다.

//myGetMethod
PImage img;
PImage cropped;

void setup() {
	size(1000, 848);
	imageMode(CENTER);
	img = loadImage("http://nktrend.diskn.com/00_gf/gf_002.jpg");

	cropped = img.get(0, 0, width, height / 2);
	frameRate(1);
}

void draw() {
	background(255);
	translate(width / 2.0, height / 2.0);
	if (0 == frameCount % 2) {
		image(img, 0, 0);
	}
	else {
		image(cropped, 0, 0);
	}

}

### 필터 적용하기 ###
### 색상 바꾸기 ###
### 노스타치 활용하기 ###

## 이미지 모자이크 만들기 ##
### 이미지 자르기 ###
### 이미지 배치하기 ###

## 평균 얼굴 만들기 ##
가끔씩 한국인의 평균얼굴 혹은 나라별 평균얼굴과 같은 사진을 기사에서 볼 수 있습니다. 혹시 이거 어떻게 한 것인지 궁금하지 않으십니까?

생각보다 간단한 원리입니다. 이미지를 투명하게 만들어 계속 겹쳐서 그리면 평균 얼굴이 화면에 남게 됩니다. 한 번 배볼까요?

### 얼굴 파일 구하기 ###
먼저 적당한 얼굴 파일을 모아야 합니다. 다음 시간에 배울 테크닉을 우선 적용해 봅시다. 자세한 내용은 다음 장에서 공부하고 여기서는 웹페이지를 분석해 웹페이지에 나온 이미지 링크를 이용해 얼굴 파일을 컴퓨터에 저장하는 작업이라는 정도로 이해하는 것으로 충분합니다.

	//myGettingFaceImages
	import java.util.ArrayList;
	import org.jsoup.Jsoup;
	import org.jsoup.nodes.Document;
	import org.jsoup.nodes.Element;
	import org.jsoup.select.Elements;
	
	String BASE_URL = "http://www.faceresearch.org";
	String web_page_url = BASE_URL + "/demos/average";
	
	ArrayList<String> imageURLs= new ArrayList<String>();
	PImage img;
	
	void setup() {
		String html = join(loadStrings(web_page_url), "");
		Document doc = Jsoup.parse(html);
		Elements inputs = doc.select("input[type=checkbox]");

		for (Element input : inputs) {
			String imageURL = trim(BASE_URL + input.attr("value"));
			imageURLs.add(imageURL);
			println(imageURL);
			PImage image = loadImage(imageURL);
			//substring(starting_index, ending_index);
			image.save(imageURL.substring(46, 57));
		}
	}

[원본 파일 위치](http://www.faceresearch.org/demos/average)
### 겹치기 ###
얼굴 파일은 현재 프로세싱 스케치 내부의 data폴더에 저장되어 있습니다. tint() 함수를 이용해 투명도를 조정한 다음 화면에 얼굴을 겹쳐 띄워봅시다.

	//myGettingFaceImages
	import java.io.File;
	File folder;
	File[] files;
	
	String fileName;
	PImage img;

	void setup() {
		size(600, 800);
		folder = new File(dataPath(""));
		files = folder.listFiles();
		tint(255, 3);
		frameRate(5);
		background(255);
	}
	
	void draw() {
		fileName = files[frameCount % files.length].getName();
		img = loadImage(fileName);
		image(img, 0, 0, 600, 800);
		if (frameCount > files.length) {
			noLoop();
		}
		println(frameCount);
	}

![](http://i.imgur.com/yRxJNiY.jpg)

생각보다 쉽지 않나요? 그럴듯한 작업을 하기 위해서 알고 있어야 하는 지식은 사실 얼마되지 않습니다. 약간의 프로그래밍 지식만으로도 멋진 작업을 할 수 있습니다.
### celebrities ###

	//myCelebrities
	import java.io.File;
	String[] names = new String[]{"xavier","magneto","wolverine","rogue","storm","burn_gorman","charlie_day","idris_elba","rinko_kikuchi","mads_mikkelsohn","hugh_dancy","gillian_anderson","scarlett_johansson","sebastian_stan","chris_evans","anthony_mackie","hayley_atwell","lucy_liu","sendhil_ramamurthy","orlando_jones","benedict_cumberbatch","chris_pine","zachary_quinto","zoe_saldana","anton_yelchin","karl_urban","john_cho","simon_pegg"};
	
	String BASE_URL = "http://psychomorph.facelab.org/demo/celebs/";
	
	File[] files;
	File folder;
	
	void setup() {
		//getImages();
		folder = new File(dataPath(""));
		files = folder.listFiles();
		size(600, 400);
		background(255);
		frameRate(1);
	}
	  
	void draw() {
		PImage img = loadImage(files[frameCount % files.length].getName());
		tint(255, 20);
		image(img, 0, 0, 300, 400);
		noTint();
		image(img, 300, 0, 300, 400);
		if (frameCount > files.length) {
			noLoop();
		}
	}
	
	void keyPressed() {
		if (key == 's' || key == 'S') {
			saveFrame("myCelebrities####.jpg");
		}
	}
	
	void getImages() {
		for (int i = 0; i < names.length; i++) {
			PImage img = loadImage(BASE_URL + names[i], "jpg");
			img.save("data/" + names[i] + ".jpg");
		}
	}

![](http://i.imgur.com/P5ojgVl.jpg)
![](http://i.imgur.com/UsNdhAT.jpg)
![](http://i.imgur.com/eG6Ahzd.jpg)